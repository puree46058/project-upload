<!DOCTYPE html>
<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>จัดการผู้ใช้งาน | สะดวกจอง</title>

    <meta name="description" content="" />

     <!-- Favicon -->
     <link rel="icon" type="image/x-icon" href="../stylesheetAdminandRes/img/logotitle-removebg-preview.png" />

     <!-- Fonts -->
     <link rel="preconnect" href="https://fonts.googleapis.com" />
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
     <link
       href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
       rel="stylesheet"
     />
 
     <!-- Icons. Uncomment required icon fonts -->
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/fonts/boxicons.css" />
 
     <!-- Core CSS -->
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/css/core.css" class="template-customizer-core-css" />
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/css/theme-default.css" class="template-customizer-theme-css" />
     <link rel="stylesheet" href="../stylesheetAdminandRes/css/demo.css"/>
 
     <!-- Vendors CSS -->
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/libs/apex-charts/apex-charts.css" />
 
     <!-- Page CSS -->
     <link href="https://emoji-css.afeld.me/emoji.css" rel="stylesheet">
     <!-- Helpers -->
     <script src="../stylesheetAdminandRes/vendor/js/helpers.js"></script>
 
     <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
     <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
     <script src="../stylesheetAdminandRes/js/config.js"></script>
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->

        <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
          <div class="app-brand demo">
            <a href="../resturant/" class="app-brand-link">
              <span class="app-brand-text demo menu-text fw-bolder ms-2"><img src="../stylesheetAdminandRes/img/logo1.png" alt=""></span>
            </a>
          </div>

          <ul class="menu-inner py-1">
            <!-- หน้าหลัก -->
            <li class="menu-item">
                <a href="../resturant/" class="menu-link">
                  <i class="menu-icon tf-icons bx bx-home-circle"></i>
                  <div data-i18n="Analytics">หน้าหลัก</div>
                </a>
              </li>
  
              <!-- เมนูจัดการต่างๆ -->
              <li class="menu-header small text-uppercase">
                <span class="menu-header-text">เมนูจัดการต่างๆ</span>
              </li>
              <!-- จัดการร้านอาหาร -->
              <li class="menu-item">
                <a href="../resturant/Profile" class="menu-link">
                  <i class="menu-icon tf-icons bx bx-user-circle"></i>
                  <div data-i18n="Layouts">ข้อมูลร้านอาหาร</div>
                </a>
              </li>
              <!-- ตรวจสอบสถานะ -->
              <li class="menu-item active">
                <a href="../resturant/ListCustomer" class="menu-link">
                  <i class="menu-icon tf-icons bx bx-user-circle"></i>
                  <div data-i18n="User interface">รายชื่อลูกค้าที่มาร้าน</div>
                </a>
              </li>
              <!-- เติมพอยต์ -->
              <li class="menu-item">
                <a href="../resturant/calendar" class="menu-link">
                  <i class="menu-icon tf-icons bx bx-calendar"></i>
                  <div data-i18n="Basic">ปฏิทิน</div>
                </a>
              </li>
              <li class="menu-item">
                <a href="../resturant/Promotion" class="menu-link">
                  <i class="menu-icon tf-icons bx bxs-coupon"></i>
                  <div data-i18n="Basic">โปรโมชั่น</div>
                </a>
              </li>
              <li class="menu-item">
                <a href="../resturant/ResturantAddPoint" class="menu-link">
                  <i class="menu-icon tf-icons bx bx-collection"></i>
                  <div data-i18n="Basic">เติมแต้ม</div>
                </a>
              </li>
              <li class="menu-item">
                <a href="../resturant/promote" class="menu-link">
                  <i class="menu-icon tf-icons bx bxs-coupon"></i>
                  <div data-i18n="Basic">โปรโมท</div>
                </a>
              </li>
              <!-- รายงาน -->
              <li class="menu-item">
                <a href="../resturant/ReportBook" class="menu-link">
                  <i class="menu-icon tf-icons bx bx-file"></i>
                  <div data-i18n="User interface">รายงาน</div>
                </a>
              </li>
          </ul>
        </aside>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

          <nav
            class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
            id="layout-navbar">
            

            <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
              <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
                <i class="bx bx-menu bx-sm"></i>
              </a>
            </div>
            
            <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
              <i class="em em-boy" aria-role="presentation" aria-label="BOY"></i><h4 class="mt-3 mx-2"><b>รายชื่อลูกค้าที่มาร้าน</b></h4><i class="em em-female_curly_haired" aria-role="presentation" aria-label=""></i>
              <ul class="navbar-nav flex-row align-items-center ms-auto">
                <li class="nav-item lh-1 me-3">
                  <a
                    href="../resturant/ResturantAddPoint"
                    class="btn btn-danger"
                    data-show-count="true"
                    style="height: 30px; padding-top: 3px; color: white; text-align: center;"
                    ><%=point.toLocaleString('en-US')%><i class="bx bxs-parking" style="vertical-align: sub;"></i></a
                  >
                </li>
                <!-- User -->
                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                  <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                    <div class="avatar avatar-online">
                      <% if (img === 'NULL') {%>
                        <center><img src="../images/profileNon.png" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"></center>
                        <%}else{%>
                        <center><img src="/uploads/profileRes/<%= img %>" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"> </center>
                        <% } %>
                    </div>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <a class="dropdown-item" href="../resturant/Profile">
                        <div class="d-flex">
                          <div class="flex-shrink-0 me-3">
                            <div class="avatar avatar-online">
                              <% if (img === 'NULL') {%>
                                <center><img src="../images/profileNon.png" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"></center>
                                <%}else{%>
                                <center><img src="/uploads/profileRes/<%= img %>" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"> </center>
                                <% } %>
                            </div>
                          </div>
                          <div class="flex-grow-1">
                            <span class="fw-semibold d-block"><%=name%></span>
                            <small class="text-muted">ร้านอาหาร</small>
                          </div>
                        </div>
                      </a>
                    </li>
                    <li>
                      <div class="dropdown-divider"></div>
                    </li>
                    <li>
                      <a class="dropdown-item" href="/resturant/logout">
                        <i class="bx bx-power-off me-2"></i>
                        <span class="align-middle">ออกจากระบบ</span>
                      </a>
                    </li>
                  </ul>
                </li>
                <!--/ User -->
              </ul>
            </div>
          </nav>

          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->

            <div class="container-xxl flex-grow-1 container-p-y">
              <% if(messages.error) {%>
                <div role="alert" class="alert alert-danger text-center mt-3" style="font-size: 18px;">
                  <%= messages.error%>
                </div>
              <% } %>
              <% if(messages.success) {%>
                  <div role="alert" class="alert alert-success text-center mt-3" style="font-size: 18px;">
                    <%= messages.success%>
                  </div>
              <% } %>
              <% if(messages.message) {%>
                  <div role="alert" class="alert alert-success text-center mt-3" style="font-size: 18px;">
                    <%= messages.message%>
                  </div>
              <% } %>
              <!-- Basic Bootstrap Table -->
              <div class="card mb-1">
                <div class="row">
                  <div class="col col-md-3">
                    <h5 class="card-header">รายชื่อลูกค้าที่มาร้าน</h5>
                   
                  </div>
                  <div class="col"></div>
                  
                  <div class="col col-md-3 my-4"><h5 style="text-align: right;">หาจากรหัสคูปอง</h5></div>
                  <div class="col col-md-3">
                    <form id="searchForm" action="/resturant/search" method="POST"> <!-- ตั้งค่า action และ method ของฟอร์ม -->
                        <input type="search" class="form-control rounded my-3" name="searchcode" placeholder="Search" aria-label="Search" aria-describedby="search-addon" />
                    </form>
                </div>
                <div class="col right">
                    <button type="submit" form="searchForm" class="btn btn-primary my-3" data-mdb-ripple-init>ค้นหา</button>
                </div>
                
                
                
                


              </div>
                <div class="table-responsive text-nowrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th style="opacity: 0;">ภาพโปรไฟล์ลูกค้า</th>
                        <th style="padding-left: 20px; font-size: 18px;">ชื่อคูปอง</th>
                        <th style="padding-left: 27px; font-size: 18px;">ชื่อลูกค้า</th>
                        <th style="font-size: 18px;">นามสกุลลูกค้า</th>
                        <th style="font-size: 18px;">เบอร์โทรศัพท์</th>
                        <th style="font-size: 18px;">วันที่จะมา</th>
                        <th style="font-size: 18px;">เวลาที่จะมา</th>
                        <th style="font-size: 18px;">รหัสคูปอง</th>
                        <th style="font-size: 18px;"><center>การจัดการ</center></th>
                      </tr>
                    </thead>
                    
                    <tbody class="table-border-bottom-0">
                    <% if(dataUser.length) { %>
                        <% for(let i = 0; i < dataUser.length; i++) { %>
                      <tr>
                        <td><% if (dataUser[i].Profile === 'NULL') {%>
                            <center><img src="../images/profileNon.png" alt="No Image" style="height: 100px; width: 100px; border-radius: 50%;"></center>
                            <%}else{%>
                            <center><img src="../uploads/profile/<%=dataUser[i].Profile %>" alt="Coupon Image" style="height: 100px; width: 100px;  border-radius: 50%;"> </center>
                            <% } %> </td>
                        <td>
                          <i class="fab fa-bootstrap fa-lg text-primary"></i> <strong><%= dataUser[i].name_pro_coupon %></strong>
                        </td>
                        <td><%= dataUser[i].fname %></td>
                        <td><span><%= dataUser[i].lname %></span></td>
                        <td><%= dataUser[i].phone %></td>
                        <td><%= new Intl.DateTimeFormat('th-TH', { year: 'numeric', month: 'long', day: '2-digit'}).format(dataUser[i].datebook) %></td>                     
                        <td><%= dataUser[i].timebook %></td>
                        <td><%= dataUser[i].cu_code %></td>
                        <td>
                            <div class="card-body" style="padding-left: 0;">
                              <div class="demo-inline-spacing">
                                <a href="ConfirmBook/<%= dataUser[i].id_user %>/<%= dataUser[i].cu_id %>"><button type="button" class="btn btn-warning">ยืนยันการจอง</button></a>
                                <a href="CancelBook/<%= dataUser[i].id_user %>/<%= dataUser[i].cu_id %>"><button type="button" class="btn btn-danger delete">ยกเลิกการจอง</button></a>
                              </div>
                            </div>
                          </td>
                      </tr>
                      <% } %>
                    <% } else{ %>
                      <td class="text-center" colspan="10">ไม่มีชื่อลูกค้าที่จะมา</td>
                    <% } %>
                    </tbody>
                    
                    
                  </table>
                </div>
              </div>
              <!--/ Basic Bootstrap Table -->

              <hr class="my-4" />

            </div>
            <!-- / Content -->

            <!-- Footer -->
            <%- include('../AdminRestaurantV2/html/layouts/footer') %>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->
    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script src="../stylesheetAdminandRes/vendor/libs/jquery/jquery.js"></script>
    <script src="../stylesheetAdminandRes/vendor/libs/popper/popper.js"></script>
    <script src="../stylesheetAdminandRes/vendor/js/bootstrap.js"></script>
    <script src="../stylesheetAdminandRes/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="../stylesheetAdminandRes/vendor/js/menu.js"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="../stylesheetAdminandRes/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->
    <script src="../stylesheetAdminandRes/js/main.js"></script>

    <!-- Page JS -->
    <script src="../stylesheetAdminandRes/js/dashboards-analytics.js"></script>
  </body>
</html>

