<!DOCTYPE html>
<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>จัดการผู้ใช้งาน | สะดวกจอง</title>

    <meta name="description" content="" />

     <!-- Favicon -->
     <link rel="icon" type="image/x-icon" href="../stylesheetAdminandRes/img/logotitle-removebg-preview.png" />

     <!-- Fonts -->
     <link rel="preconnect" href="https://fonts.googleapis.com" />
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
     <link
       href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
       rel="stylesheet"
     />
 
     <!-- Icons. Uncomment required icon fonts -->
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/fonts/boxicons.css" />
 
     <!-- Core CSS -->
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/css/core.css" class="template-customizer-core-css" />
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/css/theme-default.css" class="template-customizer-theme-css" />
     <link rel="stylesheet" href="../stylesheetAdminandRes/css/demo.css"/>
 
     <!-- Vendors CSS -->
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
     <link rel="stylesheet" href="../stylesheetAdminandRes/vendor/libs/apex-charts/apex-charts.css" />
 
     <!-- Page CSS -->
     <link href="https://emoji-css.afeld.me/emoji.css" rel="stylesheet">
     <!-- Helpers -->
     <script src="../stylesheetAdminandRes/vendor/js/helpers.js"></script>
 
     <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
     <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
     <script src="../stylesheetAdminandRes/js/config.js"></script>
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->

        <aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
          <div class="app-brand demo">
            <a href="/admin/mainadmin" class="app-brand-link">
              <span class="app-brand-text demo menu-text fw-bolder ms-2"><img src="../stylesheetAdminandRes/img/logo1.png" alt=""></span>
            </a>
          </div>

          <ul class="menu-inner py-1">
            <!-- หน้าหลัก -->
            <li class="menu-item">
              <a href="/admin/mainadmin" class="menu-link">
                <i class="menu-icon tf-icons bx bx-home-circle"></i>
                <div data-i18n="Analytics">หน้าหลัก</div>
              </a>
            </li>

            <!-- เมนูจัดการต่างๆ -->
            <li class="menu-header small text-uppercase">
              <span class="menu-header-text">เมนูจัดการต่างๆ</span>
            </li>
            <!-- จัดการร้านอาหาร -->
            <li class="menu-item">
              <a href="/admin/AdminResturant" class="menu-link">
                <i class="menu-icon tf-icons bx bx-dock-top"></i>
                <div data-i18n="Layouts">จัดการร้านอาหาร</div>
              </a>
            </li>
            <!-- จัดการผู้ใช้ -->
            <li class="menu-item active">
              <a href="/admin/AdminUser" class="menu-link">
                <i class="menu-icon tf-icons bx bx-user-circle"></i>
                <div data-i18n="Authentications">จัดการผู้ใช้งาน</div>
              </a>
            </li>
            <!-- ตรวจสอบสถานะ -->
            <li class="menu-item">
              <a href="/admin/AdminStatusResturant" class="menu-link">
                <i class="menu-icon tf-icons bx bx-check-circle"></i>
                <div data-i18n="User interface">ตรวจสอบสถานะร้านอาหาร</div>
              </a>
            </li>

            <!-- อื่นๆ -->
            <li class="menu-header small text-uppercase"><span class="menu-header-text">อื่นๆ</span></li>
            <!-- เติมพอยต์ -->
            <li class="menu-item">
              <a href="/admin/AdminPoint" class="menu-link">
                <i class="menu-icon tf-icons bx bx-collection"></i>
                <div data-i18n="Basic">เติมพอยต์</div>
              </a>
            </li>
            <!-- รายงาน -->
            <li class="menu-item">
              <a href="/admin/ReportPoint" class="menu-link">
                <i class="menu-icon tf-icons bx bx-box"></i>
                <div data-i18n="User interface">รายงาน</div>
              </a>
            </li>

            <!-- เก็บประวัติการเติมพอยต์และเข้าชมเว็บไซต์ -->
            <li class="menu-header small text-uppercase"><span class="menu-header-text">เก็บประวัติ</span></li>
            <li class="menu-item">
              <a href="/admin/HistoryWebsite" class="menu-link">
                <i class="menu-icon tf-icons bx bx-detail"></i>
                <div data-i18n="Form Elements">เก็บประวัติต่างๆ</div>
              </a>
            </li>

            <!-- จัดการเว็ปไซต์ -->
            <li class="menu-header small text-uppercase"><span class="menu-header-text">จัดการเว็ปไซต์</span></li>
            <li class="menu-item">
              <a href="/admin/managewebsite" class="menu-link">
                <i class="menu-icon tf-icons bx bx-detail"></i>
                <div data-i18n="Form Elements">จัดการเว็ปไซต์</div>
              </a>
            </li>
          </ul>
        </aside>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

          <nav
            class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
            id="layout-navbar">
            

            <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
              <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
                <i class="bx bx-menu bx-sm"></i>
              </a>
            </div>
            
            <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
              <i class="em em-boy" aria-role="presentation" aria-label="BOY"></i><h4 class="mt-3 mx-2"><b>จัดการผู้ใช้งาน</b></h4><i class="em em-female_curly_haired" aria-role="presentation" aria-label=""></i>
              <ul class="navbar-nav flex-row align-items-center ms-auto">
                
                <!-- User -->
                <li class="nav-item navbar-dropdown dropdown-user dropdown">
                  <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                    <div class="avatar avatar-online">
                      <% if (img === 'NULL') {%>
                        <center><img src="../images/profileNon.png" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"></center>
                        <%}else{%>
                        <center><img src="/uploads/profile/<%= img %>" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"> </center>
                        <% } %>
                    </div>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                      <a class="dropdown-item" href="/admin/mainadmin">
                        <div class="d-flex">
                          <div class="flex-shrink-0 me-3">
                            <div class="avatar avatar-online">
                              <% if (img === 'NULL') {%>
                                <center><img src="../images/profileNon.png" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"></center>
                                <%}else{%>
                                <center><img src="/uploads/profile/<%= img %>" alt="img" style="height: 40px; width: 40px; border-radius: 50%;"> </center>
                                <% } %>
                            </div>
                          </div>
                          <div class="flex-grow-1">
                            <span class="fw-semibold d-block"><%=name%></span>
                            <small class="text-muted">ผู้ดูแลระบบ</small>
                          </div>
                        </div>
                      </a>
                    </li>
                    <li>
                      <div class="dropdown-divider"></div>
                    </li>
                    <li>
                      <a class="dropdown-item" href="/admin/logout">
                        <i class="bx bx-power-off me-2"></i>
                        <span class="align-middle">ออกจากระบบ</span>
                      </a>
                    </li>
                  </ul>
                </li>
                <!--/ User -->
              </ul>
            </div>
          </nav>

          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->

            <div class="container-xxl flex-grow-1 container-p-y">

              <!-- Basic Bootstrap Table -->
              <div class="card mb-1">
                <h5 class="card-header">รายชื่อผู้ใช้งาน <span><a href="add">
                  <button type="button" class="btn btn-primary" style="float: inline-end;">
                    <span class="tf-icons bx bx-plus-circle"></span>&nbsp;เพิ่ม
                  </button>
                </a></span></h5>
                <div class="table-responsive text-nowrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th style="opacity: 0;">Project</th>
                        <th style="padding-left: 20px;">ชื่อผู้ใช้งาน</th>
                        <th style="padding-left: 27px;">เบอร์โทรศัพท์</th>
                        <th>อีเมล์</th>
                        <th>ระดับ</th>
                        <th>แต้มที่มี</th>
                        <th>เพิ่ม/ลบ แต้มผู้ใช้งาน</th>
                        <th>แก้ไข/ลบ</th>
                      </tr>
                    </thead>
                    
                    <tbody class="table-border-bottom-0">
                      <% if(data.length) { %>
                        <% for(let i = 0; i < data.length; i++) { %>
                          
                      <tr>
                        <td><a href="edit/<%= data[i].id %>"><% if ( data[i].Profile === 'NULL') {%>
                          <img src="../images/profileNon.png" alt="img" style="height: 120px; width: 120px; border-radius: 50%; margin: 0; padding: 0;">
                          <%}else{%>
                          <img src="/uploads/profile/<%= data[i].Profile %>" alt="img" style="height: 120px; width: 120px; border-radius: 50%;margin: 0; padding: 0;">
                          <% } %>
                        </a></td>
                        <td>
                          <i class="fab fa-bootstrap fa-lg text-primary"></i> <strong><%= data[i].fname %></strong>
                        </td>
                        <td><%= data[i].phone %></td>
                        <td><span><%= data[i].email %></span></td>
                        <td><%= data[i].level %></td>
                        <td><%=data[i].user_point%></td>
                        <td>
                          <form action="AddPointUser/<%= data[i].id_user %>" method="post">
                            <label for="addPoints">เพิ่มพอยต์:</label>
                            <input type="number" id="pointAdd" name="pointAdd" required min="1" max="10000">
                            &nbsp;<button type="submit" class="buttonlipro btn btn-success">เพิ่ม</button>
                          </form>
                          <br>
                          <form action="MinusPointUser/<%= data[i].id_user %>" method="post">
                            <label for="minusPoints" class="ml-2">ลดพอยต์:</label>
                            &nbsp;&nbsp;<input type="number" id="pointMinus" name="pointMinus" required min="1" max="10000">
                            &nbsp;<button type="submit" class="buttonlipro btn btn-danger">ลด</button>
                          </form>
                        </td>
                        <td>
                            <div class="card-body" style="padding-left: 0;">
                              <div class="demo-inline-spacing">
                                <a href="edit/<%= data[i].id %>"><button type="button" class="btn btn-warning">แก้ไข</button></a>
                                <a href="delete/<%= data[i].id %>" onclick="return alert('คุณต้องการลบผู้ใช้งาน <%= data[i].fname %> ใช่หรือไม่?')"><button type="button" class="btn btn-danger delete">ลบ</button></a>
                              </div>
                            </div>
                          </td>
                      </tr>
                      
                      <% } %>
                    <% } %>
                    </tbody>
 
                <% if(!data.length) { %>
                  <p class="text-center">ไม่มีผู้ใช้ในฐานข้อมูล</p>
                <% } %>
                  </table>
                </div>
              </div>
              <!--/ Basic Bootstrap Table -->

              <hr class="my-4" />
              <nav aria-label="Page navigation">
                <ul class="pagination justify-content-end mx-3 p-0">
                    <% if (data.length > 0) { %>
                      <% for (let i = 1; i <= Math.ceil(data.length / 4); i++) { %>
                        <li class="page-item active">
                          <a class="page-link" href="/admin/AdminUser?page=<%= i %>"><%= i %></a>
                        </li>
                      <% } %>
                    <% } %>
                </ul>
              </nav>

            </div>
            <!-- / Content -->

            

            <!-- Footer -->
            <%- include('../AdminRestaurantV2/html/layouts/footer') %>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->
    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script src="../stylesheetAdminandRes/vendor/libs/jquery/jquery.js"></script>
    <script src="../stylesheetAdminandRes/vendor/libs/popper/popper.js"></script>
    <script src="../stylesheetAdminandRes/vendor/js/bootstrap.js"></script>
    <script src="../stylesheetAdminandRes/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="../stylesheetAdminandRes/vendor/js/menu.js"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="../stylesheetAdminandRes/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->
    <script src="../stylesheetAdminandRes/js/main.js"></script>

    <!-- Page JS -->
    <script src="../stylesheetAdminandRes/js/dashboards-analytics.js"></script>

  </body>
</html>

